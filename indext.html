<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SMS Spam Detector</title>
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        margin: 40px;
      }
      .card {
        max-width: 720px;
        margin: auto;
        padding: 24px;
        border: 1px solid #ddd;
        border-radius: 12px;
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.06);
      }
      h1 {
        margin-top: 0;
        font-size: 22px;
      }
      textarea {
        width: 100%;
        min-height: 120px;
        padding: 12px;
        font-size: 15px;
        border-radius: 8px;
        border: 1px solid #ccc;
      }
      .row {
        display: flex;
        gap: 12px;
        align-items: center;
        margin: 10px 0;
      }
      input[type="number"] {
        width: 120px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 8px;
      }
      button {
        padding: 10px 16px;
        border: 0;
        border-radius: 8px;
        cursor: pointer;
      }
      .primary {
        background: #2563eb;
        color: white;
      }
      .muted {
        background: #f3f4f6;
      }
      .result {
        margin-top: 16px;
        padding: 12px;
        border-radius: 8px;
      }
      .spam {
        background: #fef2f2;
        color: #991b1b;
        border: 1px solid #fecaca;
      }
      .ham {
        background: #f0fdf4;
        color: #065f46;
        border: 1px solid #bbf7d0;
      }
      .small {
        color: #555;
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>SMS Spam Detector</h1>
      <p class="small">API: <code>http://127.0.0.1:9000/predict</code></p>

      <label for="text" class="small">Message</label>
      <textarea
        id="text"
        placeholder="Type or paste an SMS message..."
      ></textarea>

      <div class="row">
        <label for="threshold" class="small">Threshold</label>
        <input
          id="threshold"
          type="number"
          step="0.01"
          min="0"
          max="1"
          value="0.40"
        />
        <button id="btn" class="primary">Classify</button>
        <button id="clear" class="muted">Clear</button>
      </div>

      <div id="out"></div>
    </div>

    <script>
      const API = "http://127.0.0.1:9000/predict";
      const textEl = document.getElementById("text");
      const thrEl = document.getElementById("threshold");
      const outEl = document.getElementById("out");
      document.getElementById("btn").addEventListener("click", async () => {
        const text = textEl.value.trim();
        const threshold = parseFloat(thrEl.value || "0.5");
        if (!text) {
          outEl.innerHTML = '<p class="small">Please enter a message.</p>';
          return;
        }
        outEl.innerHTML = '<p class="small">Classifyingâ€¦</p>';
        try {
          const r = await fetch(API, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ text, threshold }),
          });
          const data = await r.json();
          const isSpam = data.label === "spam";
          outEl.innerHTML = `
          <div class="result ${isSpam ? "spam" : "ham"}">
            <strong>Label:</strong> ${data.label.toUpperCase()}<br/>
            <strong>Spam probability:</strong> ${(
              data.spam_probability * 100
            ).toFixed(1)}%<br/>
            <span class="small"><strong>Threshold:</strong> ${
              data.threshold
            }</span>
          </div>`;
        } catch (e) {
          outEl.innerHTML =
            '<div class="result spam">Error calling API. Is it running?</div>';
          console.error(e);
        }
      });
      document.getElementById("clear").addEventListener("click", () => {
        textEl.value = "";
        outEl.innerHTML = "";
      });
    </script>
  </body>
</html>
